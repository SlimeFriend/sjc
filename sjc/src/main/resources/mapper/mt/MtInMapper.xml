<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sjc.app.mt.mapper.MtInMapper">

	<!-- 품질검사완료 된 자재만 입고 목록에 포함 -->
	<select id="getCompletedMaterials"
		resultType="com.sjc.app.mt.service.MtInVO">
     select 
        MT_IN.LOT_NO AS lotNo,
        MT_IN.MTL_OD_CODE,
        MT.MT_CODE AS mtCode,
        MT.MT_NAME AS mtName ,
        MT_IN.INQUANTITY AS inquantity ,
        MT_IN.INPUT_DATE AS inputDate ,
        MT_IN.ED AS ed,
        MT_IN. COMM AS comm
        FROM MT_IN
        JOIN MT ON MT_IN.MT_CODE = MT.MT_CODE
        ORDER BY MT_IN.LOT_NO
	</select>


	<!-- 자재 입고 시 재고 업데이트 -->
	<update id="updateCurrentStockAfterReceiving"
		parameterType="com.sjc.app.mt.service.MtInVO">
		UPDATE MT
		SET CURRENT_STC = CURRENT_STC + #{inquantity}
		WHERE MT_CODE = #{mtCode}
	</update>

</mapper>
