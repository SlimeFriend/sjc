<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	xmlns:layout="http://www.ultraq.net/thymeleaf/layout"
	layout:decorate="~{common/layouts/default_layout}"
	layout:fragment="Content">
<head>
<meta charset="UTF-8">
<title>전체 재고 관리</title>
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<style>
.text-danger {
	color: red;
}
</style>
</head>
<body>
	<div class="main-container">
		<div class="container">
			<h1>전체 재고 관리</h1>

			<!-- 재고 목록 테이블 -->
			<table class="table table-striped">
				<thead>
					<tr>
						<th>자재 코드</th>
						<th>자재 이름</th>
						<th>자재 구분</th>
						<th>규격</th>
						<th>단위</th>
						<th>단가</th>
						<th>안전재고</th>
						<th>현재재고</th>
						<th>비고</th>
					</tr>
				</thead>
				<tbody>
					<!-- 재고 목록이 없을 경우 -->
					<tr th:if="${#lists.isEmpty(materials)}">
						<td colspan="9" class="text-center">등록된 재고가 없습니다.</td>
					</tr>
					<!-- 재고 목록이 있을 경우 -->
					<tr th:each="material : ${materials}">
						<td th:text="${material.mtCode}">자재 코드</td>
						<td th:text="${material.mtName}">자재 이름</td>
						<td th:text="${material.materialType}">자재 구분</td>
						<td th:text="${material.specification}">규격</td>
						<td th:text="${material.unit}">단위</td>
						<td th:text="${material.unitPrice}">단가</td>
						<td
							th:text="${material.safetyStock != null ? material.safetyStock : '-'}">안전재고</td>
						<td
							th:classappend="${material.currentStc != null and material.currentStc < material.safetyStock} ? 'text-danger' : ''"
							th:text="${material.currentStc != null ? material.currentStc : '-'}">현재재고</td>
						<td th:text="${material.comm != null ? material.comm : '-'}">비고</td>
					</tr>
				</tbody>
			</table>

			
			<!-- 자재 구분 입력 및 저장하는 폼 -->
			<h2>자재 구분 입력 및 저장</h2>
			<form th:action="@{/stock/updateMaterialType}" method="post"
				class="form-inline">
				<div class="form-group mb-2">
					<label for="mtCode" class="sr-only">자재 코드</label> <input
						type="text" class="form-control mr-2" id="mtCode" name="mtCode"
						placeholder="자재 코드" required>
				</div>
				<div class="form-group mb-2">
					<label for="materialType" class="sr-only">자재 구분</label> <input
						type="text" class="form-control mr-2" id="materialType"
						name="materialType" placeholder="자재 구분" required>
				</div>
				<button type="submit" class="btn btn-primary mb-2">저장</button>
			</form>

			<!-- 안전재고에서 현재 재고로 이동하는 폼 -->
			
			<h2>안전재고에서 현재 재고로 이동</h2>
			<form th:action="@{/stock/moveSafetyStock}" method="post"
				class="form-inline">
				<div class="form-group mb-2">
					<label for="mtCodeStock" class="sr-only">자재 코드</label> <input
						type="text" class="form-control mr-2" id="mtCodeStock"
						name="mtCode" placeholder="자재 코드" required>
				</div>
				<div class="form-group mb-2">
					<label for="quantity" class="sr-only">이동 수량</label> <input
						type="number" class="form-control mr-2" id="quantity"
						name="quantity" placeholder="이동 수량" required>
				</div>
				<button type="submit" class="btn btn-primary mb-2">업데이트</button>
			</form>



			<!-- 성공 또는 오류 메시지 표시 -->
			<div th:if="${message}" class="alert alert-success mt-3"
				th:text="${message}"></div>
			<div th:if="${error}" class="alert alert-danger mt-3"
				th:text="${error}"></div>
		</div>
	</div>
</body>
</html>
